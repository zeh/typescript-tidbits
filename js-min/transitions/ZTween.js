define(["require","exports","../signals/SimpleSignal","Easing"],function(t,e,i,s){var r;!function(t){var e;!function(t){var e=function(){function t(e,n,h){void 0===n&&(n=null),void 0===h&&(h=null),this._target=e,this.properties=new Array;for(var a in n)this.properties.push(new r(a,n[a]));this.timeCreated=t.currentTime,this.timeStart=this.timeCreated,this.time=0,this.delay=0,this.transition=s["default"].none,this._onStart=new i["default"],this._onUpdate=new i["default"],this._onComplete=new i["default"],null!=h&&(h.hasOwnProperty("time")&&(this.time=h.time),h.hasOwnProperty("delay")&&(this.delay=h.delay),h.hasOwnProperty("transition")&&(this.transition=h.transition),h.hasOwnProperty("onStart")&&this._onStart.add(h.onStart),h.hasOwnProperty("onUpdate")&&this._onUpdate.add(h.onUpdate),h.hasOwnProperty("onComplete")&&this._onComplete.add(h.onComplete)),this._useFrames=!1,this._paused=!1,this.started=!1}return t._init=function(){this.currentTimeFrame=0,this.currentTime=0,this.frameTick()},t.prototype.updateCache=function(){this.timeDuration=this.timeComplete-this.timeStart},t.updateTweens=function(){for(this.l=this.tweens.length,this.i=0;this.i<this.l;this.i++)null!=this.tweens[this.i]&&this.tweens[this.i].update(this.currentTime,this.currentTimeFrame)||(this.tweens.splice(this.i,1),this.i--,this.l--)},t.frameTick=function(){this.currentTime=(new Date).getTime(),this.currentTimeFrame++,this.updateTweens(),window.requestAnimationFrame(this.frameTick.bind(this))},t.add=function(e,i,s){void 0===i&&(i=null),void 0===s&&(s=null);var r=new t(e,i,s);return this.tweens.push(r),r},t.updateTime=function(){this.currentTime=(new Date).getTime()},t.remove=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var s,r,n=[],h=this.tweens.length;for(s=0;h>s;s++)if(null!=this.tweens[s]&&this.tweens[s]._target==t)if(e.length>0){for(r=0;r<this.tweens[s].properties.length;r++)e.indexOf(this.tweens[s].properties[r].name)>-1&&(this.tweens[s].properties.splice(r,1),r--);0==this.tweens[s].properties.length&&n.push(this.tweens[s])}else n.push(this.tweens[s]);var a=!1;for(h=n.length,s=0;h>s;s++)r=this.tweens.indexOf(n[s]),this.removeTweenByIndex(r),a=!0;return a},t.hasTween=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var s,r,n=this.tweens.length;for(s=0;n>s;s++)if(null!=this.tweens[s]&&this.tweens[s]._target==t){if(!(e.length>0))return!0;for(r=0;r<this.tweens[s].properties.length;r++)if(e.indexOf(this.tweens[s].properties[r].name)>-1)return!0}return!1},t.getTweens=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var s,r,n,h=[],a=this.tweens.length;for(s=0;a>s;s++)if(null!=this.tweens[s]&&this.tweens[s]._target==t)if(e.length>0){for(n=!1,r=0;r<this.tweens[s].properties.length;r++)if(e.indexOf(this.tweens[s].properties[r].name)>-1){n=!0;break}n&&h.push(this.tweens[s])}else h.push(this.tweens[s]);return h},t.pause=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var s,r=!1,n=this.getTweens.apply(null,[t].concat(e));for(s=0;s<n.length;s++)n[s].paused||(n[s].pause(),r=!0);return r},t.resume=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var s,r=!1,n=this.getTweens.apply(null,[t].concat(e));for(s=0;s<n.length;s++)n[s].paused&&(n[s].resume(),r=!0);return r},t.removeTweenByIndex=function(t){this.tweens[t]=null},t.prototype.update=function(t,e){if(this._paused)return!0;if(this.cTime=this._useFrames?e:t,this.started||this.cTime>=this.timeStart){if(!this.started){for(this._onStart.dispatch(),this.i=0;this.i<this.properties.length;this.i++)this.tProperty=this.properties[this.i],this.pv=this._target[this.tProperty.name],this.tProperty.valueStart=isNaN(this.pv)?this.tProperty.valueComplete:this.pv,this.tProperty.valueChange=this.tProperty.valueComplete-this.tProperty.valueStart;this.started=!0}if(this.cTime>=this.timeComplete){for(this.i=0;this.i<this.properties.length;this.i++)this.tProperty=this.properties[this.i],this._target[this.tProperty.name]=this.tProperty.valueComplete;return this._onUpdate.dispatch(),this._onComplete.dispatch(),!1}for(this.t=this.transition((this.cTime-this.timeStart)/this.timeDuration),this.i=0;this.i<this.properties.length;this.i++)this.tProperty=this.properties[this.i],this._target[this.tProperty.name]=this.tProperty.valueStart+this.t*this.tProperty.valueChange;this._onUpdate.dispatch()}return!0},t.prototype.pause=function(){this._paused||(this._paused=!0,this.timePaused=this._useFrames?t.currentTimeFrame:t.currentTime)},t.prototype.resume=function(){if(this._paused){this._paused=!1;var e=this._useFrames?t.currentTimeFrame:t.currentTime;this.timeStart+=e-this.timePaused,this.timeComplete+=e-this.timePaused}},Object.defineProperty(t.prototype,"delay",{get:function(){return(this.timeStart-this.timeCreated)/(this._useFrames?1:1e3)},set:function(t){this.timeStart=this.timeCreated+t*(this._useFrames?1:1e3),this.timeComplete=this.timeStart+this.timeDuration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){return(this.timeComplete-this.timeStart)/(this._useFrames?1:1e3)},set:function(t){this.timeComplete=this.timeStart+t*(this._useFrames?1:1e3),this.updateCache()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paused",{get:function(){return this._paused},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useFrames",{get:function(){return this._useFrames},set:function(e){var i=this.delay,s=this.time;this._useFrames=e,this.timeStart=this._useFrames?t.currentTimeFrame:t.currentTime,this.delay=i,this.time=s},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onStart",{get:function(){return this._onStart},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onUpdate",{get:function(){return this._onUpdate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onComplete",{get:function(){return this._onComplete},enumerable:!0,configurable:!0}),t.tweens=[],t}();t.ZTween=e;var r=function(){function t(t,e){this.name=t,this.valueComplete=e}return t}();e._init()}(e=t.transitions||(t.transitions={}))}(r||(r={}))});